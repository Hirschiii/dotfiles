#!/bin/env bash

# Colortheme
# Switch between light and dark mode for Neovim (Cattpuccin) and Alacritty
# Dependencies:
# - Neovim with lua
#   - The neovim Plugin "carppuccin/nvim"
# - dmenu
#   - Font: FiraCode Nerd Font
# - Alacritty
#   - Colortheme: light and dark
# - sed

# Farben/Font f√ºr dmenu

black="#1E1D2D"
gray2="#282737"
green="#ABE9B3"
red="#F28FAD"

font="FiraCode Nerd Font:style=Retina,Regular:size=14:autohint=true"

# Alacritty

alacritty_colorscheme_dir="$HOME/.config/alacritty/colorscheme.yml"

# nvim

light="latte"
dark="mocha"
nvim_colorscheme_dir="$HOME/.config/nvim/lua/user/colorscheme.lua"

# for the toggle

declare -A my_toggle

my_toggle[dark]="light"
my_toggle[light]="dark"


Print_Help ()
{
     # Display Help
   echo "Colortheme 0.1.2"
   echo "Change between Dark and Lightmode"
   echo "for Neovim with Cattpuccin and Alacritty with custom colorschemes (dark / light)"
   echo
   echo "Syntax: Colortheme [-h]"
   echo "options:"
   echo "no option      toggle light and dark mode"
   echo "-h             Print Help"
   echo "-i             interactiv mode, you can choose the theme"
   echo "-t             DEFAULT - toggle between light and dark mode"
   echo
}

toggle ()
{
  now="$(cat ~/.config/alacritty/colorscheme.yml | grep colors: | sed 's/colors: \*//')"

  ChangeMode ${my_toggle[$now]}
}

interactiv ()
{
  
  pick=$(echo -e "dark\nlight" | dmenu -p "Pick Color Sheme" -fn "$font" -nb "$black" -nf "$green" -sb "$gray2" -sf "$red")

  if [ -z $pick ];
  then
    exit 
  fi

  ChangeMode $pick

}

ChangeMode ()
{


  sed -i "s/^colors: *.*/colors: *$1/" $alacritty_colorscheme_dir


  sed -i "s/^vim\.g\.catppuccin_flavour = \".*\"/vim\.g\.catppuccin_flavour = \"${!1}\"/" $nvim_colorscheme_dir

}

if [ -z $@ ]; then
  toggle
else
  case "$1" in
    -i) interactiv 
    ;;
    -t) toggle
    ;;
    -h) Print_Help 
    ;;
    *) Print_Help
    ;;
  esac
fi
